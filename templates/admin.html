<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Admin Dashboard</title>

    <link rel="stylesheet" href="{{ url_for('static', filename='css/admin.css') }}">
</head>

<body>

<!-- ================= TOP HEADER ================= -->
<div class="top-header">
    <div class="brand">Applicant Resume Analyzer (ARA)</div>
    <a href="/admin-logout" class="logout-btn">Logout</a>
</div>

<!-- ================= TAB NAVIGATION ================= -->
<div class="nav-bar">
    <button class="nav-item" onclick="openTab('dataTab')">Database</button>
    <button class="nav-item" onclick="openTab('filterTab')">Filter & Sort</button>
    <button class="nav-item" onclick="openTab('analysisTab')">Analysis</button>
    <button class="nav-item" onclick="openTab('aboutTab')">About Us</button>
</div>

<!-- ================= DATA TAB ================= -->
<div id="dataTab" class="tab-content">
    <div class="table-container">
        {% set rows = all_data %}
        {% include "resume_table.html" %}
    </div>
</div>

<!-- ================= FILTER TAB ================= -->
<div id="filterTab" class="tab-content">

    <div class="filter-section">
        <form method="get" class="filter-bar">
            <input type="hidden" name="filter" value="1">

            <select name="job_role">
                <option value="">All Job Roles</option>
                {% for role in job_roles %}
                <option value="{{ role }}" {% if role == selected_role %}selected{% endif %}>
                    {{ role }}
                </option>
                {% endfor %}
            </select>

            <select name="min_exp">
                <option value="">Any Experience</option>
                <option value="0" {% if selected_exp == '0' %}selected{% endif %}>Fresher</option>
                <option value="2" {% if selected_exp == '2' %}selected{% endif %}>2+ Years</option>
                <option value="5" {% if selected_exp == '5' %}selected{% endif %}>5+ Years</option>
            </select>

            <select name="sort">
                <option value="score" {% if selected_sort == "score" %}selected{% endif %}>
                    Sort by Score
                </option>
                <option value="experience" {% if selected_sort == "experience" %}selected{% endif %}>
                    Sort by Experience
                </option>
            </select>

            <button type="submit">Apply</button>
        </form>
    </div>

    <div class="table-container">
        {% set rows = filtered_data %}
        {% include "resume_table.html" %}
    </div>
</div>

<!-- ================= ANALYSIS TAB (MATPLOTLIB + SEABORN) ================= -->
<div id="analysisTab" class="tab-content">

    <!-- KPI CARDS -->
    <div class="kpi-container">
        <div class="kpi">Total Resumes<br><b>{{ overview[0] }}</b></div>
        <div class="kpi">Job Roles<br><b>{{ overview[1] }}</b></div>
        <div class="kpi">Avg Score<br><b>{{ overview[2] }}</b></div>
    </div>

    <!-- CHARTS (SERVER-RENDERED IMAGES) -->
    <div class="chart-grid">

        <div class="chart-box">
            <h4>Job Role Distribution</h4>
            <img src="data:image/png;base64,{{ charts.job_role }}" alt="Job Role Distribution">
        </div>

        <div class="chart-box">
            <h4>Score Distribution</h4>
            <img src="data:image/png;base64,{{ charts.score }}" alt="Score Distribution">
        </div>

        <div class="chart-box">
            <h4>Experience vs Score</h4>
            <img src="data:image/png;base64,{{ charts.exp_score }}" alt="Experience vs Score">
        </div>

        <div class="chart-box">
            <h4>Top Skills</h4>
            <img src="data:image/png;base64,{{ charts.skills }}" alt="Top Skills">
        </div>

    </div>
</div>

<!-- ================= ABOUT TAB ================= -->
<div id="aboutTab" class="tab-content">
    <div class="about-section">
        <h3>About This Application</h3>

        <p>
            Hiring the right candidate is not just about reading resumes, it is about
            understanding skills, experience, and potential at scale. This application
            was built to simplify that process.
        </p>

        <p>
            Applicant Resume Analyzer (ARA) intelligently reads and analyzes resumes
            using Natural Language Processing and machine learning techniques. Instead of
            manually scanning hundreds of profiles, recruiters get structured insights
            such as job role suitability, experience relevance, and resume strength in
            seconds.
        </p>

        <p>
            Every uploaded resume is processed to extract meaningful information -
            skills, education, experience, and overall profile quality. These factors
            are then evaluated to generate a score that helps identify the most relevant
            candidates quickly and objectively.
        </p>

        <p>
            This dashboard empowers recruiters to filter, rank, and compare applicants
            using data-driven insights rather than subjective judgment. It reduces hiring
            time, improves consistency, and ensures that strong candidates are never
            overlooked.
        </p>

        <p>
            In short, this application bridges the gap between raw resumes and smarter
            hiring decisions - making recruitment faster, fairer, and more efficient.
        </p>
    </div>
</div>

<!-- ================= TAB SCRIPT (ONLY FOR UI) ================= -->
<script>
function openTab(tabId) {
    const tabs = document.querySelectorAll(".tab-content");
    const buttons = document.querySelectorAll(".nav-item");

    tabs.forEach(tab => tab.classList.remove("active"));
    buttons.forEach(btn => btn.classList.remove("active"));

    document.getElementById(tabId).classList.add("active");
    event.target.classList.add("active");
}

// AUTO SELECT TAB ON PAGE LOAD
window.onload = function () {
    const params = new URLSearchParams(window.location.search);

    if (params.get("filter") === "1") {
        openTabById("filterTab", 1);
    } else {
        openTabById("dataTab", 0);
    }
};

function openTabById(tabId, btnIndex) {
    const tabs = document.querySelectorAll(".tab-content");
    const buttons = document.querySelectorAll(".nav-item");

    tabs.forEach(tab => tab.classList.remove("active"));
    buttons.forEach(btn => btn.classList.remove("active"));

    document.getElementById(tabId).classList.add("active");
    buttons[btnIndex].classList.add("active");
}
</script>

</body>
</html>